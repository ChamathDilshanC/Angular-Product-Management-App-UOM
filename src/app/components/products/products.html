<!-- HTML Template -->
<div class="container-fluid mt-5">
  <div class="row">
    <section [ngClass]="showaddproduct ? 'col-md-7' : 'col-md-12'">
      <!-- Header Section -->
      <div class="mb-3 d-flex justify-content-between align-items-center">
        <h1>Product List</h1>
        <div>
          <button *ngIf="!showaddproduct" (click)="showAddProduct()" class="btn btn-primary">
            Add Product
          </button>
          <button *ngIf="showaddproduct" (click)="hideAddProduct()" class="btn btn-danger">
            Hide Add Product
          </button>
        </div>
      </div>

      <!-- Product Table -->
      <div class="table-responsive">
        <table class="table table-striped">
          <thead>
            <tr class="table-primary">
              <th scope="col">#</th>
              <th scope="col">Product Name</th>
              <th scope="col">Price</th>
              <th scope="col">Category</th>
              <th scope="col">Quantity</th>
              <th scope="col">Availability</th>
              <th scope="col">Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr
              *ngFor="let product of productList; let i = index"
              (click)="selectProduct(i)"
              [class.selected-row]="rowIndexNumber === i"
              [class.disabled]="!isRowSelected"
            >
              <th scope="row">{{ i + 1 }}</th>
              <td>{{ product.name }}</td>
              <td>{{ product.price | currency }}</td>
              <td>{{ product.category }}</td>
              <td
                [ngClass]="{
                  'bg-danger text-white': product.quantity === 0,
                  'bg-warning text-dark': product.quantity > 0 && product.quantity <= 5,
                  'bg-success text-white': product.quantity > 5
                }"
              >
                {{ product.quantity }}
              </td>
              <td>
                <span *ngIf="product.quantity === 0" class="badge bg-danger"> Out of Stock </span>
                <span
                  *ngIf="product.quantity > 0 && product.quantity <= 5"
                  class="badge bg-warning text-dark"
                >
                  Low Stock
                </span>
                <span *ngIf="product.quantity > 5" class="badge bg-success"> Available </span>
              </td>
              <td>
                <button
                  class="btn btn-sm btn-primary me-2"
                  [disabled]="!(isRowSelected && rowIndexNumber === i)"
                  title="Edit Product"
                  (click)="editProduct(i)"
                >
                  <i class="fas fa-edit"></i>
                </button>
                <button
                  class="btn btn-sm btn-danger"
                  [disabled]="!(isRowSelected && rowIndexNumber === i)"
                  title="Delete Product"
                  (click)="deleteProduct(i); $event.stopPropagation()"
                >
                  <i class="fas fa-trash"></i>
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>

    <!-- Add/Edit Product Section -->
    <section class="col-md-5" *ngIf="showaddproduct || showeditproduct">
      <app-add-product *ngIf="showaddproduct" (add)="addProduct($event)"></app-add-product>
      <app-edit-product
        *ngIf="showeditproduct"
        [product]="productList[rowIndexNumber!]"
        [index]="rowIndexNumber"
        (update)="updateProduct($event.index, $event.product)"
      ></app-edit-product>
    </section>
  </div>
</div>
